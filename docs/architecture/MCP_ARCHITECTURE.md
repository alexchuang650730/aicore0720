# PowerAutomation MCP架構

## 🏗️ MCP組件架構圖

```
┌─────────────────────────────────────────────────────────────┐
│                     PowerAutomation Core                      │
├─────────────────────────────────────────────────────────────┤
│                      MCP Manager                              │
│  統一管理所有MCP組件，提供標準化接口                             │
└────────────────┬───────────────────────────────────────────┘
                 │
    ┌────────────┴────────────┬────────────┬──────────────┐
    │                         │            │              │
┌───▼────┐          ┌────────▼───┐  ┌────▼─────┐  ┌─────▼────┐
│Router  │          │  K2 Chat   │  │Memory RAG│  │  Cache   │
│  MCP   │          │    MCP     │  │   MCP    │  │   MCP    │
├────────┤          ├────────────┤  ├──────────┤  ├──────────┤
│智能路由│          │Moonshot K2 │  │ RAG增強  │  │高速緩存  │
│決策引擎│          │Groq備用    │  │風格對齊  │  │LRU策略   │
└───┬────┘          └──────┬─────┘  └────┬─────┘  └────┬─────┘
    │                      │              │              │
    └──────────────────────┴──────────────┴──────────────┘
                           │
                    ┌──────▼───────┐
                    │ 統一響應接口  │
                    └──────────────┘
```

## 📦 MCP組件列表

### 1. **Router MCP** - 智能路由器
- 分析查詢類型
- 選擇最佳AI提供商
- 平衡速度、質量、成本

### 2. **K2 Chat MCP** - 核心對話引擎
- Moonshot K2為主
- Groq超快備用
- 自動降級機制

### 3. **Memory RAG MCP** - 記憶增強
- Claude行為學習
- K2響應優化
- 風格對齊

### 4. **Cache MCP** - 緩存加速
- 響應緩存
- LRU驅逐策略
- 分佈式就緒

### 5. **Workflow MCP** - 工作流引擎
- 六大自動化工作流
- 任務編排
- 狀態管理

### 6. **ClaudeEditor MCP** - 編輯器集成
- 雙向通信
- IDE功能
- 實時協作

### 7. **SmartUI MCP** - UI生成
- 智能界面生成
- 響應式設計
- 組件庫管理

## 🔄 請求流程

1. **用戶請求** → MCP Manager
2. **Router MCP** 分析並路由
3. **Cache MCP** 檢查緩存
4. **K2 Chat MCP** 生成響應
5. **Memory RAG MCP** 增強優化
6. **統一響應** → 用戶

## 🎯 架構優勢

- **模塊化**: 每個功能獨立MCP組件
- **可擴展**: 輕鬆添加新MCP組件
- **高性能**: 緩存+並行處理
- **容錯性**: 自動降級和錯誤恢復
- **標準化**: 統一的MCP接口規範
