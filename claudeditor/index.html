<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClaudeEditor v4.7.3 - AI-Powered Code Editor with Core MCP Integration</title>
    
    <!-- Monaco Editor CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    
    <!-- Core Dependency Checker -->
    <script src="core_dependency_check.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* å¯¼èˆªæ æ ·å¼ */
        .top-nav {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .nav-left, .nav-center, .nav-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-left {
            gap: 20px;
        }
        .nav-center {
            flex: 1;
            justify-content: flex-end;
        }
        .nav-title {
            color: white;
            font-weight: 700;
            font-size: 24px;
        }
        .nav-icon {
            font-size: 24px;
        }
        .nav-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }
        
        /* ClaudeEditoræ ‡é¢˜æ ·å¼ - çº¯æ©™è‰² */
        .claude-title {
            color: #FF8C00 !important;
            font-size: 24px !important;
            font-weight: 700 !important;
            letter-spacing: 0.5px;
            background: none !important;
            -webkit-background-clip: initial !important;
            -webkit-text-fill-color: #FF8C00 !important;
            text-shadow: none !important;
            filter: none !important;
        }
        
        .nav-right {
            display: flex;
            gap: 8px;
        }
        .nav-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        .nav-btn.active {
            background: rgba(255,255,255,0.4);
            font-weight: 600;
        }
        .btn-icon {
            font-size: 16px;
        }
        
        /* ä¸»å†…å®¹åŒºåŸŸ */
        .main-content {
            flex: 1;
            display: grid;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }
        .main-content.edit-mode {
            grid-template-columns: 300px 1fr;
        }
        .main-content.chat-mode {
            grid-template-columns: 300px 2fr;
        }
        .main-content.present-mode {
            grid-template-columns: 1fr;
        }
        
        .panel {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .panel h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* AIæ¨¡å‹æ§åˆ¶é¢æ¿æ ·å¼ */
        .ai-control-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            color: white;
        }
        .ai-control-section h2 {
            color: white;
            margin-bottom: 15px;
        }
        .model-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        .model-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 12px;
            padding: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        .model-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        .model-btn.active {
            background: rgba(255,255,255,0.4);
            border-color: rgba(255,255,255,0.6);
            box-shadow: 0 4px 15px rgba(255,255,255,0.2);
        }
        .model-name {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        .model-type {
            font-size: 12px;
            opacity: 0.9;
        }
        .model-info {
            margin-bottom: 15px;
        }
        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        .token-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        .token-card {
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
        }
        .token-icon {
            font-size: 20px;
            margin-bottom: 6px;
        }
        .token-label {
            font-size: 11px;
            opacity: 0.9;
            margin-bottom: 4px;
        }
        .token-value {
            font-size: 16px;
            font-weight: 700;
        }
        .efficiency-info {
            border-top: 1px solid rgba(255,255,255,0.2);
            padding-top: 12px;
        }
        .efficiency-rate {
            color: #4ade80;
            font-weight: 700;
        }
        
        /* å¿«é€Ÿæ“ä½œåŒºæ ·å¼ */
        .quick-actions {
            margin-top: 20px;
        }
        .action-button {
            width: 100%;
            margin: 8px 0;
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        .action-button:active {
            transform: translateY(0);
        }
        
        /* å¿«é€ŸæŒ‡ä»¤åŒºåŸŸ */
        .quick-command {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }
        .command-input-container {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        .command-input {
            flex: 1;
            padding: 8px 12px;
            background: #1e1e1e;
            color: white;
            border: 2px solid #333;
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            transition: border-color 0.3s ease;
            height: 36px;
        }
        .command-input:focus {
            outline: none;
            border-color: #667eea;
        }
        .command-input::placeholder {
            color: #888;
        }
        .command-execute {
            padding: 0;
            width: 44px;
            height: 36px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .command-execute:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        /* æ–‡ä»¶åˆ—è¡¨æ ·å¼ */
        .file-list {
            margin-top: 20px;
        }
        .file-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }
        .file-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .file-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        .file-icon {
            font-size: 18px;
            margin-right: 12px;
        }
        .file-info {
            flex: 1;
        }
        .file-name {
            font-weight: 600;
            margin-bottom: 4px;
        }
        .file-meta {
            font-size: 12px;
            opacity: 0.7;
        }
        .file-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            background: #28a745;
            color: white;
        }
        
        /* å…­å¤§å·¥ä½œæµæ ·å¼ */
        .workflow-details {
            margin-top: 20px;
        }
        .workflow-summary {
            list-style: none;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 12px;
        }
        .workflow-summary::-webkit-details-marker {
            display: none;
        }
        .workflow-summary h2 {
            margin: 0;
            color: #667eea;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .dropdown-arrow {
            font-size: 12px;
            color: #9ca3af;
            transition: transform 0.3s ease;
        }
        .workflow-details[open] .dropdown-arrow {
            transform: rotate(180deg);
        }
        .workflow-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 12px;
        }
        .workflow-item {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .workflow-item:hover {
            background: #e9ecef;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        /* é¡¹ç›®çŠ¶æ€æ ·å¼ */
        .project-status {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .workflow-item.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        .workflow-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        .workflow-label {
            font-size: 12px;
            font-weight: 600;
        }
        .workflow-status {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
        }
        
        /* ç¼–è¾‘å™¨æ ·å¼ - ä¼˜åŒ–å¸ƒå±€ */
        .editor-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        .editor-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: none; /* ç§»é™¤è¾¹æ¡† */
        }
        .file-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        .editor-actions {
            display: flex;
            gap: 8px;
        }
        .editor-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        .editor-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Monaco Editorå®¹å™¨ - ç´§è´´æ ‡é¢˜æ  */
        .monaco-container {
            flex: 1;
            margin: 0; /* ç§»é™¤è¾¹è· */
            padding: 0; /* ç§»é™¤å†…è¾¹è· */
            background: #1e1e1e;
            position: relative;
        }
        #monaco-editor {
            width: 100%;
            height: 100%;
            border: none; /* ç§»é™¤è¾¹æ¡† */
        }
        
        /* å¤‡ç”¨ç¼–è¾‘å™¨æ ·å¼ */
        .fallback-editor {
            width: 100%;
            height: 100%;
            border: none;
            background: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            padding: 20px;
            resize: none;
            outline: none;
        }
                /* AIåŠ©æ‰‹æ ·å¼ */
        .ai-assistant {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        /* éƒ¨ç½²å¯¹è¯æ¡†æ ·å¼ */
        .deployment-dialog {
            padding: 20px;
        }
        .deployment-dialog h2 {
            color: #333;
            margin-bottom: 15px;
        }
        .file-selection {
            margin-top: 20px;
        }
        .deploy-file-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .deploy-file-item:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }
        .deploy-file-item .file-icon {
            font-size: 24px;
            margin-right: 15px;
        }
        .deploy-file-item .file-info {
            flex: 1;
        }
        .deploy-file-item .file-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }
        .deploy-file-item .file-size {
            color: #666;
            font-size: 12px;
        }
        .deploy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .deploy-btn:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        /* éƒ¨ç½²è¿›åº¦æ ·å¼ */
        .deployment-progress {
            padding: 20px;
            text-align: center;
        }
        .deployment-progress h3 {
            color: #333;
            margin-bottom: 20px;
        }
        .progress-steps {
            text-align: left;
        }
        .progress-steps .step {
            padding: 10px 0;
            color: #666;
            border-left: 3px solid #e9ecef;
            padding-left: 15px;
            margin: 5px 0;
        }
        .progress-steps .step.active {
            color: #667eea;
            border-left-color: #667eea;
            font-weight: 600;
        }
        .progress-steps .step.completed {
            color: #28a745;
            border-left-color: #28a745;
        }
        
        /* éƒ¨ç½²ç»“æœæ ·å¼ */
        .deployment-result {
            padding: 20px;
            text-align: center;
        }
        .deployment-result h3 {
            color: #28a745;
            margin-bottom: 20px;
        }
        .deploy-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: left;
        }
        .deploy-info p {
            margin: 8px 0;
            color: #333;
        }
        .deploy-info a {
            color: #667eea;
            text-decoration: none;
        }
        .deploy-info a:hover {
            text-decoration: underline;
        }
        .deploy-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        .action-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .action-btn:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        /* éƒ¨ç½²è¯´æ˜æ ·å¼ */
        .deployment-note {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        .deployment-note p {
            margin: 0 0 10px 0;
            color: #333;
            font-weight: 600;
        }
        .deployment-note ul {
            margin: 0;
            padding-left: 20px;
        }
        .deployment-note li {
            margin: 5px 0;
            color: #666;
        }
        
        /* ç»ˆç«¯è¿æ¥æ ·å¼ */
        .terminal-connection {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
        }
        .terminal-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 15px 0;
        }
        .terminal-option {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .terminal-option:hover {
            background: #e9ecef;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .terminal-icon {
            font-size: 24px;
            margin-right: 15px;
        }
        .terminal-info {
            flex: 1;
        }
        .terminal-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }
        .terminal-desc {
            font-size: 14px;
            color: #666;
        }
        .connect-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .connect-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        .adapter-info {
            background: #f0f8ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        .adapter-info h4 {
            margin: 0 0 10px 0;
            color: #0066cc;
        }
        .adapter-info ul {
            margin: 0;
            padding-left: 20px;
        }
        .adapter-info li {
            margin: 5px 0;
            color: #333;
        }
        .connection-progress {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
        }
        .terminal-preview {
            background: #1e1e1e;
            border-radius: 8px;
            margin-top: 15px;
            overflow: hidden;
        }
        .terminal-header {
            background: #333;
            color: white;
            padding: 8px 15px;
            font-size: 14px;
            border-bottom: 1px solid #555;
        }
        .terminal-content {
            padding: 15px;
            font-family: 'Courier New', monospace;
            color: #00ff00;
            background: #000;
        }
        .terminal-line {
            margin: 5px 0;
            font-size: 14px;
        }
        .cursor {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* æ–°åŠŸèƒ½æ ·å¼ */
        .folder-browser, .git-clone, .ssh-connection {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 10px 0;
        }
        .folder-input, .git-input {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        .path-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .browse-btn {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 15px;
            cursor: pointer;
        }
        .folder-actions, .git-actions, .ssh-actions {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        .action-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
        }
        .action-btn.secondary {
            background: #6c757d;
        }
        .folder-info, .git-info, .ssh-info {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }
        .ssh-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .form-group label {
            font-weight: 600;
            color: #333;
        }
        .file-input, .port-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .port-input {
            width: 80px;
        }
        .ssh-features {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .feature-btn {
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 12px;
        }
        .git-options {
            margin: 10px 0;
        }
        .git-options label {
            display: block;
            margin: 5px 0;
        }    height: 100%;
            display: flex;
            flex-direction: column;
        }
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            max-height: 400px;
        }
        .message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 10px;
            line-height: 1.5;
        }
        .message.user {
            background: #667eea;
            color: white;
            margin-left: 20px;
        }
        .message.ai {
            background: white;
            border: 1px solid #e9ecef;
            margin-right: 20px;
        }
        .chat-input-container {
            display: flex;
            gap: 10px;
        }
        .chat-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        .chat-input:focus {
            outline: none;
            border-color: #667eea;
        }
        .chat-send {
            padding: 12px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .chat-send:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-content.edit-mode,
            .main-content.chat-mode {
                grid-template-columns: 1fr;
            }
            .nav-left {
                gap: 10px;
            }
            .nav-title {
                font-size: 18px;
            }
            .claude-title {
                font-size: 18px !important;
            }
        }
        
        /* éšè—ç±» */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="top-nav">
        <div class="nav-left">
            <div class="nav-title">
                <span class="nav-icon">ğŸŒ</span>
                PowerAutomation
            </div>
            <div class="claude-title">
                ClaudeEditor
            </div>
        </div>
        <div class="nav-center">
            <div class="nav-right">
                <button class="nav-btn active" onclick="switchMode('edit')">
                    <span class="btn-icon">âœï¸</span>
                    ç¼–è¾‘
                </button>
                <button class="nav-btn" onclick="switchMode('present')">
                    <span class="btn-icon">ğŸ¯</span>
                    æ¼”ç¤º
                </button>
                <button class="nav-btn" onclick="switchMode('chat')">
                    <span class="btn-icon">ğŸ’¬</span>
                    å¯¹è¯
                </button>
            </div>
        </div>
    </div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-content edit-mode" id="mainContent">
        <!-- å·¦ä¾§é¢æ¿ -->
        <div class="panel">
            <!-- AIæ¨¡å‹æ§åˆ¶ -->
            <div class="ai-control-section">
                <h2>
                    <span class="icon">ğŸ¤–</span>
                    AIæ¨¡å‹æ§åˆ¶
                </h2>
                
                <div class="model-buttons">
                    <div class="model-btn" onclick="switchModel('k2')">
                        <div class="model-name">K2</div>
                        <div class="model-type">é«˜çº§</div>
                    </div>
                    <div class="model-btn active" onclick="switchModel('claude')">
                        <div class="model-name">Claude</div>
                        <div class="model-type">æ ‡å‡†</div>
                    </div>
                </div>
                
                <div class="model-info">
                    <div class="info-row">
                        <span class="info-label">å½“å‰æ¨¡å‹:</span>
                        <span class="info-value" id="currentModel">Claude-3.5-Sonnet</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">å½“å‰ä»“åº“:</span>
                        <span class="info-value">aicore0716</span>
                    </div>
                </div>
                
                <div class="token-stats">
                    <div class="token-card">
                        <div class="token-icon">ğŸ’°</div>
                        <div class="token-label">å·²èŠ‚çœToken</div>
                        <div class="token-value">12,847</div>
                    </div>
                    <div class="token-card">
                        <div class="token-icon">ğŸ“Š</div>
                        <div class="token-label">æ€»Tokenä½¿ç”¨</div>
                        <div class="token-value">45,623</div>
                    </div>
                </div>
                
                <div class="efficiency-info">
                    <div class="info-row">
                        <span>èŠ‚çœç‡:</span>
                        <span class="efficiency-rate">28.2%</span>
                    </div>
                    <div class="info-row">
                        <span>ä¸Šæ¬¡åˆ‡æ¢:</span>
                        <span id="lastSwitch">2åˆ†é’Ÿå‰</span>
                    </div>
                </div>
            </div>

            <!-- å¿«é€Ÿæ“ä½œåŒº -->
            <div class="quick-actions">
                <h2>âš¡ å¿«é€Ÿæ“ä½œ</h2>
                
                <button class="action-button" onclick="openFolder()" id="openFolderBtn">
                    <span>ğŸ“‚ æ‰“å¼€æ–‡ä»¶å¤¹</span>
                    <span>â†’</span>
                </button>
                
                <button class="action-button" onclick="cloneRepository()" id="cloneRepoBtn">
                    <span>ğŸ”„ å…‹éš†Gitä»“åº“</span>
                    <span>â†’</span>
                </button>
                
                <button class="action-button" onclick="connectRemote()" id="connectRemoteBtn">
                    <span>ğŸ’» è¿æ¥è¿œç¨‹ä¸»æœº</span>
                    <span>â†’</span>
                </button>
                
                <button class="action-button" onclick="connectLocalTerminal()" id="connectLocalBtn">
                    <span>ğŸ–¥ï¸ è¿æ¥æœ¬åœ°ç»ˆç«¯</span>
                    <span>â†’</span>
                </button>
            </div>

            <!-- å¿«é€ŸæŒ‡ä»¤ç³»ç»Ÿ -->
            <div class="quick-command">
                <h2>âš¡ å¿«é€ŸæŒ‡ä»¤</h2>
                <div class="command-input-container">
                    <input type="text" class="command-input" id="commandInput" 
                           placeholder="è¾“å…¥æŒ‡ä»¤ (å¦‚: /deploy, /analyze, /init...)" 
                           onkeypress="handleCommandKeyPress(event)">
                    <button class="command-execute" onclick="executeCommand()">â†’</button>
                </div>
            </div>

            <!-- æœ€è¿‘æ–‡ä»¶ -->
            <div class="file-list">
                <h2>ğŸ“„ æœ€è¿‘æ–‡ä»¶</h2>
                
                <div class="file-item" onclick="openFile('å½’çº³å™¨_v1.2.0.js', 'javascript')">
                    <div class="file-icon">ğŸ“„</div>
                    <div class="file-info">
                        <div class="file-name">å½’çº³å™¨_v1.2.0.js</div>
                        <div class="file-meta">856KB â€¢ 4å°æ—¶å‰</div>
                    </div>
                </div>
                
                <div class="file-item" onclick="openFile('SmartUILayout_å“åº”å¼å¸ƒå±€ç»„ä»¶_v2.1.jsx', 'javascript')">
                    <div class="file-icon">âš›ï¸</div>
                    <div class="file-info">
                        <div class="file-name">SmartUILayout_å“åº”å¼å¸ƒå±€ç»„ä»¶_v2.1.jsx</div>
                        <div class="file-meta">124KB â€¢ 6å°æ—¶å‰</div>
                    </div>
                </div>
                
                <div class="file-item" onclick="openFile('MCP_åè°ƒå™¨æ ¸å¿ƒæ¨¡å—_v3.0.py', 'python')">
                    <div class="file-icon">ğŸ</div>
                    <div class="file-info">
                        <div class="file-name">MCP_åè°ƒå™¨æ ¸å¿ƒæ¨¡å—_v3.0.py</div>
                        <div class="file-meta">89KB â€¢ 8å°æ—¶å‰</div>
                    </div>
                </div>
            </div>

            <!-- å…­å¤§å·¥ä½œæµDashboard -->
            <details class="workflow-details">
                <summary class="workflow-summary">
                    <h2>ğŸ¯ å…­å¤§å·¥ä½œæµDashboard</h2>
                    <span class="dropdown-arrow">â–¼</span>
                </summary>
                
                <div class="workflow-grid">
                    <div class="workflow-item" onclick="selectWorkflow('analyze')">
                        <div class="workflow-status"></div>
                        <div class="workflow-icon">ğŸ”</div>
                        <div class="workflow-label">ä»£ç åˆ†æ</div>
                    </div>
                    
                    <div class="workflow-item" onclick="selectWorkflow('refactor')">
                        <div class="workflow-status"></div>
                        <div class="workflow-icon">ğŸ› ï¸</div>
                        <div class="workflow-label">è‡ªåŠ¨é‡æ„</div>
                    </div>
                    
                    <div class="workflow-item" onclick="selectWorkflow('test')">
                        <div class="workflow-status"></div>
                        <div class="workflow-icon">ğŸ§ª</div>
                        <div class="workflow-label">å•å…ƒæµ‹è¯•</div>
                    </div>
                    
                    <div class="workflow-item" onclick="selectWorkflow('build')">
                        <div class="workflow-status"></div>
                        <div class="workflow-icon">ğŸ“¦</div>
                        <div class="workflow-label">æ„å»ºéƒ¨ç½²</div>
                    </div>
                    
                    <div class="workflow-item" onclick="selectWorkflow('optimize')">
                        <div class="workflow-status"></div>
                        <div class="workflow-icon">ğŸš€</div>
                        <div class="workflow-label">æ€§èƒ½ä¼˜åŒ–</div>
                    </div>
                    
                    <div class="workflow-item" onclick="selectWorkflow('monitor')">
                        <div class="workflow-status"></div>
                        <div class="workflow-icon">ğŸ“Š</div>
                        <div class="workflow-label">ç›‘æ§è¿ç»´</div>
                    </div>
                </div>
            </details>
        </div>

        <!-- ç¼–è¾‘å™¨åŒºåŸŸ -->
        <div class="editor-container" id="editorContainer">
            <div class="editor-header">
                <div class="file-title">
                    <span class="file-icon">ğŸ“„</span>
                    <span id="fileName">é€‰æ‹©æ–‡ä»¶å¼€å§‹ç¼–è¾‘</span>
                    <span id="fileSize"></span>
                </div>
                <div class="editor-actions">
                    <button class="editor-btn" onclick="saveFile()">ğŸ’¾ ä¿å­˜</button>
                    <button class="editor-btn" onclick="closeFile()">âœ–ï¸ å…³é—­</button>
                </div>
            </div>
            <div class="monaco-container">
                <div id="monaco-editor"></div>
            </div>
        </div>

        <!-- AIåŠ©æ‰‹åŒºåŸŸ (ä»…åœ¨å¯¹è¯æ¨¡å¼æ˜¾ç¤º) -->
        <div class="ai-assistant hidden" id="aiAssistant">
            <h2>ğŸ¤– AI ç¼–ç¨‹åŠ©æ‰‹</h2>
            <div class="chat-messages" id="chatMessages">
                <div class="message ai">
                    ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯ ClaudeEditor v4.7.3 AI åŠ©æ‰‹ï¼Œç°åœ¨é…å¤‡äº†å¢å¼ºåŠŸèƒ½ï¼<br><br>
                    âœ¨ <strong>æ–°åŠŸèƒ½äº®ç‚¹ï¼š</strong><br>
                    â€¢ ğŸ¯ 12ä¸ªæ ¸å¿ƒå¿«é€ŸæŒ‡ä»¤<br>
                    â€¢ ğŸ“ å¤šè¯­è¨€è¯­æ³•é«˜äº®æ”¯æŒ<br>
                    â€¢ ğŸ”§ ä¼˜åŒ–çš„ç¼–è¾‘å™¨å¸ƒå±€<br>
                    â€¢ âš¡ å¢å¼ºçš„å¿«é€Ÿæ“ä½œåŠŸèƒ½<br><br>
                    ğŸ¯ <strong>ç«‹å³ä½“éªŒï¼š</strong><br>
                    ç‚¹å‡»å·¦ä¾§å¿«é€Ÿæ“ä½œæŒ‰é’®æˆ–è¾“å…¥å¿«é€ŸæŒ‡ä»¤ï¼
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" 
                       placeholder="è¾“å…¥æ¶ˆæ¯æˆ–å¿«é€ŸæŒ‡ä»¤..." 
                       onkeypress="handleChatKeyPress(event)">
                <button class="chat-send" onclick="sendMessage()">å‘é€</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentMode = 'edit';
        let currentModel = 'claude';
        let monacoEditor = null;
        let currentFile = null;
        
        // åç«¯æœåŠ¡é…ç½®
        const BACKEND_URL = 'https://5000-irhw1cjxvsvet50ykelqe-5d94768d.manusvm.computer';
        let terminalSocket = null;
        let activeTerminalSession = null;
        
        // Monaco Editoråˆå§‹åŒ–
        function initMonacoEditor() {
            if (typeof monaco !== 'undefined') {
                // Monaco Editorå·²åŠ è½½ï¼Œç›´æ¥åˆå§‹åŒ–
                createEditor();
            } else {
                // åŠ è½½Monaco Editor
                require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' }});
                require(['vs/editor/editor.main'], function() {
                    createEditor();
                });
            }
        }
        
        function createEditor() {
            const container = document.getElementById('monaco-editor');
            if (!container) return;
            
            try {
                monacoEditor = monaco.editor.create(container, {
                    value: '// é€‰æ‹©å·¦ä¾§æ–‡ä»¶å¼€å§‹ç¼–è¾‘\n// ClaudeEditor v4.7.3 - å¢å¼ºç‰ˆä»£ç ç¼–è¾‘å™¨\n\n// æ”¯æŒçš„è¯­è¨€:\n// - JavaScript (.js, .jsx)\n// - Python (.py)\n// - HTML (.html)\n// - CSS (.css)\n// - JSON (.json)\n// - æ›´å¤šè¯­è¨€æŒç»­æ·»åŠ ä¸­...\n\nconsole.log("æ¬¢è¿ä½¿ç”¨ ClaudeEditor v4.7.3!");',
                    language: 'javascript',
                    theme: 'vs-dark',
                    automaticLayout: true,
                    fontSize: 14,
                    lineNumbers: 'on',
                    roundedSelection: false,
                    scrollBeyondLastLine: false,
                    readOnly: false,
                    minimap: { enabled: true },
                    wordWrap: 'on',
                    folding: true,
                    lineDecorationsWidth: 10,
                    lineNumbersMinChars: 3,
                    glyphMargin: false
                });
                
                // ç›‘å¬ç¼–è¾‘å™¨å˜åŒ–
                monacoEditor.onDidChangeModelContent(() => {
                    // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è‡ªåŠ¨ä¿å­˜é€»è¾‘
                });
                
                console.log('Monaco Editor åˆå§‹åŒ–æˆåŠŸ');
            } catch (error) {
                console.error('Monaco Editor åˆå§‹åŒ–å¤±è´¥:', error);
                // ä½¿ç”¨å¤‡ç”¨ç¼–è¾‘å™¨
                createFallbackEditor();
            }
        }
        
        function createFallbackEditor() {
            const container = document.getElementById('monaco-editor');
            container.innerHTML = '<textarea class="fallback-editor" placeholder="ä»£ç ç¼–è¾‘å™¨åŠ è½½ä¸­..."></textarea>';
            console.log('ä½¿ç”¨å¤‡ç”¨ç¼–è¾‘å™¨');
        }
        
        // æ¨¡å¼åˆ‡æ¢
        function switchMode(mode) {
            currentMode = mode;
            const mainContent = document.getElementById('mainContent');
            const aiAssistant = document.getElementById('aiAssistant');
            const editorContainer = document.getElementById('editorContainer');
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.nav-btn').classList.add('active');
            
            // åˆ‡æ¢å¸ƒå±€
            switch(mode) {
                case 'edit':
                    mainContent.className = 'main-content edit-mode';
                    aiAssistant.classList.add('hidden');
                    editorContainer.classList.remove('hidden');
                    break;
                case 'chat':
                    mainContent.className = 'main-content chat-mode';
                    aiAssistant.classList.remove('hidden');
                    editorContainer.classList.add('hidden');
                    break;
                case 'present':
                    mainContent.className = 'main-content present-mode';
                    aiAssistant.classList.remove('hidden');
                    editorContainer.classList.add('hidden');
                    showDeploymentDialog();
                    break;
            }
            
            // é‡æ–°è°ƒæ•´ç¼–è¾‘å™¨å¤§å°
            if (monacoEditor && mode !== 'chat') {
                setTimeout(() => {
                    monacoEditor.layout();
                }, 100);
            }
        }
        
        // æ˜¾ç¤ºéƒ¨ç½²å¯¹è¯æ¡†
        function showDeploymentDialog() {
            const deploymentHtml = `
                <div class="deployment-dialog">
                    <h2>ğŸš€ é¡¹ç›®éƒ¨ç½²</h2>
                    <p>è¯·é€‰æ‹©è¦éƒ¨ç½²çš„<strong>é¡¹ç›®</strong>ï¼ˆåªæœ‰å®Œæ•´çš„ä»£ç é¡¹ç›®æ‰èƒ½éƒ¨ç½²ï¼‰ï¼š</p>
                    <div class="file-selection">
                        <div class="deploy-file-item" onclick="deployProject('ClaudeEditor-v4.7.3', 'frontend')">
                            <div class="file-icon">ğŸŒ</div>
                            <div class="file-info">
                                <div class="file-name">ClaudeEditor v4.7.3</div>
                                <div class="file-size">å®Œæ•´å‰ç«¯é¡¹ç›® â€¢ HTML/CSS/JavaScript</div>
                            </div>
                            <button class="deploy-btn">éƒ¨ç½²</button>
                        </div>
                        <div class="deploy-file-item" onclick="deployProject('SmartUILayout-System', 'react')">
                            <div class="file-icon">âš›ï¸</div>
                            <div class="file-info">
                                <div class="file-name">SmartUILayout å“åº”å¼å¸ƒå±€ç³»ç»Ÿ</div>
                                <div class="file-size">Reacté¡¹ç›® â€¢ ç»„ä»¶åº“ç³»ç»Ÿ</div>
                            </div>
                            <button class="deploy-btn">éƒ¨ç½²</button>
                        </div>
                        <div class="deploy-file-item" onclick="deployProject('MCP-Coordinator-Service', 'python')">
                            <div class="file-icon">ğŸ</div>
                            <div class="file-info">
                                <div class="file-name">MCPåè°ƒå™¨æœåŠ¡</div>
                                <div class="file-size">Pythonåç«¯æœåŠ¡ â€¢ Flask API</div>
                            </div>
                            <button class="deploy-btn">éƒ¨ç½²</button>
                        </div>
                    </div>
                    <div class="deployment-note">
                        <p><strong>ğŸ“ æ³¨æ„ï¼š</strong></p>
                        <ul>
                            <li>âœ… <strong>é¡¹ç›®éƒ¨ç½²</strong>ï¼šå®Œæ•´çš„ä»£ç é¡¹ç›®å¯ä»¥éƒ¨ç½²ä¸ºç½‘ç«™æˆ–æœåŠ¡</li>
                            <li>ğŸ“ <strong>æ–‡ä»¶ç¼–è¾‘</strong>ï¼šæ‰€æœ‰æ–‡ä»¶éƒ½å¯ä»¥åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€å’Œç¼–è¾‘</li>
                            <li>ğŸ”§ <strong>å•ä¸ªæ–‡ä»¶</strong>ï¼šä¸èƒ½ç›´æ¥éƒ¨ç½²ï¼Œéœ€è¦å®Œæ•´é¡¹ç›®ç»“æ„</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('chatMessages').innerHTML = deploymentHtml;
        }
        
        // éƒ¨ç½²é¡¹ç›®ï¼ˆä¸æ˜¯å•ä¸ªæ–‡ä»¶ï¼‰
        function deployProject(projectName, type) {
            const deploymentSteps = [
                'ğŸ” æ­£åœ¨åˆ†æé¡¹ç›®ç»“æ„...',
                'ğŸ“¦ æ­£åœ¨æ„å»ºé¡¹ç›®...',
                'ğŸ”§ æ­£åœ¨ä¼˜åŒ–èµ„æº...',
                'ğŸŒ æ­£åœ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ...',
                'âœ… éƒ¨ç½²å®Œæˆï¼'
            ];
            
            let currentStep = 0;
            const chatMessages = document.getElementById('chatMessages');
            
            // æ˜¾ç¤ºéƒ¨ç½²å¼€å§‹
            chatMessages.innerHTML = `
                <div class="deployment-progress">
                    <h3>ğŸš€ æ­£åœ¨éƒ¨ç½²é¡¹ç›®: ${projectName}</h3>
                    <div class="progress-steps">
                        <div class="step active">${deploymentSteps[0]}</div>
                    </div>
                </div>
            `;
            
            // æ¨¡æ‹Ÿéƒ¨ç½²è¿‡ç¨‹
            const deployInterval = setInterval(() => {
                currentStep++;
                if (currentStep < deploymentSteps.length) {
                    const progressHtml = `
                        <div class="deployment-progress">
                            <h3>ğŸš€ æ­£åœ¨éƒ¨ç½²é¡¹ç›®: ${projectName}</h3>
                            <div class="progress-steps">
                                ${deploymentSteps.slice(0, currentStep + 1).map(step => 
                                    `<div class="step ${currentStep === deploymentSteps.length - 1 ? 'completed' : 'active'}">${step}</div>`
                                ).join('')}
                            </div>
                        </div>
                    `;
                    chatMessages.innerHTML = progressHtml;
                } else {
                    clearInterval(deployInterval);
                    // æ˜¾ç¤ºéƒ¨ç½²å®Œæˆç»“æœ
                    const deployUrl = `https://${projectName.toLowerCase().replace(/[^a-z0-9]/g, '-')}.manus.space`;
                    chatMessages.innerHTML = `
                        <div class="deployment-result">
                            <h3>âœ… é¡¹ç›®éƒ¨ç½²æˆåŠŸï¼</h3>
                            <div class="deploy-info">
                                <p><strong>é¡¹ç›®åç§°:</strong> ${projectName}</p>
                                <p><strong>é¡¹ç›®ç±»å‹:</strong> ${type === 'frontend' ? 'å‰ç«¯ç½‘ç«™' : type === 'react' ? 'Reactåº”ç”¨' : 'PythonæœåŠ¡'}</p>
                                <p><strong>éƒ¨ç½²åœ°å€:</strong> <a href="${deployUrl}" target="_blank">${deployUrl}</a></p>
                                <p><strong>éƒ¨ç½²æ—¶é—´:</strong> ${new Date().toLocaleString()}</p>
                            </div>
                            <div class="deploy-actions">
                                <button onclick="window.open('${deployUrl}', '_blank')" class="action-btn">ğŸŒ è®¿é—®ç½‘ç«™</button>
                                <button onclick="showDeploymentDialog()" class="action-btn">ğŸ”„ éƒ¨ç½²å…¶ä»–é¡¹ç›®</button>
                            </div>
                        </div>
                    `;
                }
            }, 1500);
        }
        
        // AIæ¨¡å‹åˆ‡æ¢
        function switchModel(model) {
            currentModel = model;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.model-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.model-btn').classList.add('active');
            
            // æ›´æ–°æ¨¡å‹ä¿¡æ¯
            const modelName = model === 'k2' ? 'K2-Advanced' : 'Claude-3.5-Sonnet';
            document.getElementById('currentModel').textContent = modelName;
            document.getElementById('lastSwitch').textContent = 'åˆšåˆš';
            
            // æ˜¾ç¤ºåˆ‡æ¢æˆåŠŸæ¶ˆæ¯
            addChatMessage('ai', `ğŸ¤– <strong>AIæ¨¡å‹å·²åˆ‡æ¢</strong><br>å½“å‰æ¨¡å‹: ${modelName}<br>âœ… æ¨¡å‹åˆ‡æ¢æˆåŠŸï¼`);
        }
        
        // æ–‡ä»¶æ“ä½œ
        function openFile(fileName, language) {
            currentFile = { name: fileName, language: language };
            
            // æ›´æ–°æ–‡ä»¶æ ‡é¢˜
            document.getElementById('fileName').textContent = fileName;
            document.getElementById('fileSize').textContent = '';
            
            // æ›´æ–°æ–‡ä»¶åˆ—è¡¨é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.file-item').classList.add('active');
            
            // åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼
            if (currentMode !== 'edit') {
                switchMode('edit');
                // æ‰‹åŠ¨æ›´æ–°æŒ‰é’®çŠ¶æ€
                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector('.nav-btn[onclick="switchMode(\'edit\')"]').classList.add('active');
            }
            
            // åŠ è½½æ–‡ä»¶å†…å®¹åˆ°ç¼–è¾‘å™¨
            loadFileContent(fileName, language);
        }
        
        function loadFileContent(fileName, language) {
            let content = '';
            let monacoLanguage = language;
            
            // æ ¹æ®æ–‡ä»¶ç±»å‹ç”Ÿæˆç¤ºä¾‹å†…å®¹
            switch(language) {
                case 'javascript':
                    if (fileName.includes('.jsx')) {
                        monacoLanguage = 'javascript';
                        content = `// ${fileName}
// Reactç»„ä»¶ç¤ºä¾‹ - ClaudeEditor v4.7.3

import React, { useState, useEffect } from 'react';

const SmartUILayout = ({ children, responsive = true }) => {
    const [screenSize, setScreenSize] = useState('desktop');
    
    useEffect(() => {
        const handleResize = () => {
            const width = window.innerWidth;
            if (width < 768) {
                setScreenSize('mobile');
            } else if (width < 1024) {
                setScreenSize('tablet');
            } else {
                setScreenSize('desktop');
            }
        };
        
        window.addEventListener('resize', handleResize);
        handleResize();
        
        return () => window.removeEventListener('resize', handleResize);
    }, []);
    
    return (
        <div className={\`smart-layout \${screenSize}\`}>
            <header className="layout-header">
                <h1>ClaudeEditor v4.7.3</h1>
            </header>
            <main className="layout-content">
                {children}
            </main>
            <footer className="layout-footer">
                <p>Powered by ClaudeEditor</p>
            </footer>
        </div>
    );
};

export default SmartUILayout;`;
                    } else {
                        content = `// ${fileName}
// JavaScriptæ¨¡å—ç¤ºä¾‹ - ClaudeEditor v4.7.3

class DocumentSummarizer {
    constructor(options = {}) {
        this.maxLength = options.maxLength || 500;
        this.language = options.language || 'zh-CN';
        this.version = '1.2.0';
    }
    
    /**
     * å½’çº³æ–‡æ¡£å†…å®¹
     * @param {string} content - åŸå§‹æ–‡æ¡£å†…å®¹
     * @returns {Promise<string>} å½’çº³åçš„å†…å®¹
     */
    async summarize(content) {
        try {
            // æ–‡æœ¬é¢„å¤„ç†
            const cleanContent = this.preprocessText(content);
            
            // å…³é”®å¥æå–
            const keyPhrases = this.extractKeyPhrases(cleanContent);
            
            // ç”Ÿæˆæ‘˜è¦
            const summary = this.generateSummary(keyPhrases);
            
            return summary;
        } catch (error) {
            console.error('å½’çº³è¿‡ç¨‹å‡ºé”™:', error);
            throw new Error('æ–‡æ¡£å½’çº³å¤±è´¥');
        }
    }
    
    preprocessText(text) {
        return text
            .replace(/\\s+/g, ' ')
            .replace(/[^\\u4e00-\\u9fa5a-zA-Z0-9\\s.,!?]/g, '')
            .trim();
    }
    
    extractKeyPhrases(text) {
        // ç®€å•çš„å…³é”®è¯æå–ç®—æ³•
        const sentences = text.split(/[ã€‚ï¼ï¼Ÿ.!?]/);
        return sentences
            .filter(s => s.length > 10)
            .slice(0, 5);
    }
    
    generateSummary(phrases) {
        return phrases.join('ã€‚') + 'ã€‚';
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const summarizer = new DocumentSummarizer({
    maxLength: 300,
    language: 'zh-CN'
});

export default DocumentSummarizer;`;
                    }
                    break;
                    
                case 'python':
                    content = `# ${fileName}
# Pythonæ¨¡å—ç¤ºä¾‹ - ClaudeEditor v4.7.3

import asyncio
import json
from typing import Dict, List, Optional
from dataclasses import dataclass
from datetime import datetime

@dataclass
class MCPMessage:
    """MCPåè°ƒå™¨æ¶ˆæ¯ç±»"""
    id: str
    type: str
    content: Dict
    timestamp: datetime
    priority: int = 1

class MCPCoordinator:
    """MCPåè°ƒå™¨æ ¸å¿ƒæ¨¡å— v3.0"""
    
    def __init__(self, config: Dict = None):
        self.config = config or {}
        self.version = "3.0"
        self.active_connections = {}
        self.message_queue = []
        self.handlers = {}
        
    async def initialize(self):
        """åˆå§‹åŒ–åè°ƒå™¨"""
        print(f"MCPåè°ƒå™¨ v{self.version} åˆå§‹åŒ–ä¸­...")
        await self._setup_handlers()
        await self._start_message_processor()
        print("âœ… MCPåè°ƒå™¨åˆå§‹åŒ–å®Œæˆ")
    
    async def _setup_handlers(self):
        """è®¾ç½®æ¶ˆæ¯å¤„ç†å™¨"""
        self.handlers = {
            'command': self._handle_command,
            'file_operation': self._handle_file_operation,
            'deployment': self._handle_deployment,
            'analysis': self._handle_analysis
        }
    
    async def _start_message_processor(self):
        """å¯åŠ¨æ¶ˆæ¯å¤„ç†å™¨"""
        asyncio.create_task(self._process_messages())
    
    async def _process_messages(self):
        """å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—"""
        while True:
            if self.message_queue:
                message = self.message_queue.pop(0)
                await self._route_message(message)
            await asyncio.sleep(0.1)
    
    async def _route_message(self, message: MCPMessage):
        """è·¯ç”±æ¶ˆæ¯åˆ°å¯¹åº”å¤„ç†å™¨"""
        handler = self.handlers.get(message.type)
        if handler:
            try:
                await handler(message)
            except Exception as e:
                print(f"âŒ å¤„ç†æ¶ˆæ¯å¤±è´¥: {e}")
    
    async def _handle_command(self, message: MCPMessage):
        """å¤„ç†å‘½ä»¤æ¶ˆæ¯"""
        command = message.content.get('command')
        print(f"ğŸ”§ æ‰§è¡Œå‘½ä»¤: {command}")
        
        # å‘½ä»¤å¤„ç†é€»è¾‘
        if command == '/deploy':
            await self._execute_deployment()
        elif command == '/analyze':
            await self._execute_analysis()
        elif command == '/init':
            await self._execute_initialization()
    
    async def _handle_file_operation(self, message: MCPMessage):
        """å¤„ç†æ–‡ä»¶æ“ä½œ"""
        operation = message.content.get('operation')
        file_path = message.content.get('path')
        print(f"ğŸ“ æ–‡ä»¶æ“ä½œ: {operation} - {file_path}")
    
    async def _handle_deployment(self, message: MCPMessage):
        """å¤„ç†éƒ¨ç½²è¯·æ±‚"""
        target = message.content.get('target')
        print(f"ğŸš€ éƒ¨ç½²åˆ°: {target}")
    
    async def _handle_analysis(self, message: MCPMessage):
        """å¤„ç†åˆ†æè¯·æ±‚"""
        analysis_type = message.content.get('type')
        print(f"ğŸ“Š æ‰§è¡Œåˆ†æ: {analysis_type}")
    
    async def send_message(self, message_type: str, content: Dict):
        """å‘é€æ¶ˆæ¯"""
        message = MCPMessage(
            id=f"msg_{len(self.message_queue)}",
            type=message_type,
            content=content,
            timestamp=datetime.now()
        )
        self.message_queue.append(message)
    
    async def _execute_deployment(self):
        """æ‰§è¡Œéƒ¨ç½²"""
        print("ğŸš€ å¼€å§‹éƒ¨ç½²æµç¨‹...")
        # éƒ¨ç½²é€»è¾‘
        
    async def _execute_analysis(self):
        """æ‰§è¡Œåˆ†æ"""
        print("ğŸ“Š å¼€å§‹ä»£ç åˆ†æ...")
        # åˆ†æé€»è¾‘
        
    async def _execute_initialization(self):
        """æ‰§è¡Œåˆå§‹åŒ–"""
        print("ğŸ”§ å¼€å§‹é¡¹ç›®åˆå§‹åŒ–...")
        # åˆå§‹åŒ–é€»è¾‘

# ä½¿ç”¨ç¤ºä¾‹
async def main():
    coordinator = MCPCoordinator()
    await coordinator.initialize()
    
    # å‘é€æµ‹è¯•æ¶ˆæ¯
    await coordinator.send_message('command', {'command': '/deploy'})

if __name__ == "__main__":
    asyncio.run(main())`;
                    break;
                    
                default:
                    content = `// ${fileName}
// ClaudeEditor v4.7.3 - å¤šè¯­è¨€æ”¯æŒ

// æ”¯æŒçš„è¯­è¨€ç±»å‹:
// - JavaScript (.js, .jsx)
// - Python (.py)
// - HTML (.html)
// - CSS (.css)
// - JSON (.json)
// - TypeScript (.ts, .tsx)
// - æ›´å¤šè¯­è¨€æŒç»­æ·»åŠ ä¸­...

console.log("æ¬¢è¿ä½¿ç”¨ ClaudeEditor v4.7.3!");
console.log("å½“å‰æ–‡ä»¶: ${fileName}");
console.log("è¯­è¨€ç±»å‹: ${language}");`;
            }
            
            // æ›´æ–°ç¼–è¾‘å™¨å†…å®¹å’Œè¯­è¨€
            if (monacoEditor) {
                monacoEditor.setValue(content);
                monaco.editor.setModelLanguage(monacoEditor.getModel(), monacoLanguage);
            }
        }
        
        function saveFile() {
            if (!currentFile) {
                addChatMessage('ai', 'âŒ æ²¡æœ‰æ‰“å¼€çš„æ–‡ä»¶å¯ä»¥ä¿å­˜');
                return;
            }
            
            const content = monacoEditor ? monacoEditor.getValue() : '';
            addChatMessage('ai', `ğŸ’¾ <strong>æ–‡ä»¶å·²ä¿å­˜</strong><br>æ–‡ä»¶: ${currentFile.name}<br>å¤§å°: ${content.length} å­—ç¬¦`);
        }
        
        function closeFile() {
            currentFile = null;
            document.getElementById('fileName').textContent = 'é€‰æ‹©æ–‡ä»¶å¼€å§‹ç¼–è¾‘';
            document.getElementById('fileSize').textContent = '';
            
            // æ¸…é™¤æ–‡ä»¶é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // é‡ç½®ç¼–è¾‘å™¨
            if (monacoEditor) {
                monacoEditor.setValue('// é€‰æ‹©å·¦ä¾§æ–‡ä»¶å¼€å§‹ç¼–è¾‘\\n// ClaudeEditor v4.7.3 - å¢å¼ºç‰ˆä»£ç ç¼–è¾‘å™¨');
                monaco.editor.setModelLanguage(monacoEditor.getModel(), 'javascript');
            }
        }
        
        // å¿«é€Ÿæ“ä½œåŠŸèƒ½ - å®ç°çœŸå®åŠŸèƒ½
        function openFolder() {
            console.log('æ‰“å¼€æ–‡ä»¶å¤¹æŒ‰é’®è¢«ç‚¹å‡»');
            
            const folderHtml = `
                <div class="folder-browser">
                    <h3>ğŸ“‚ æ‰“å¼€æ–‡ä»¶å¤¹</h3>
                    <p>é€‰æ‹©è¦æ‰“å¼€çš„æœ¬åœ°æ–‡ä»¶å¤¹ï¼š</p>
                    
                    <div class="folder-input">
                        <input type="text" id="folderPath" placeholder="è¾“å…¥æ–‡ä»¶å¤¹è·¯å¾„ (å¦‚: /Users/username/Documents)" class="path-input">
                        <button onclick="browseFolderPath()" class="browse-btn">æµè§ˆ</button>
                    </div>
                    
                    <div class="folder-actions">
                        <button onclick="openSelectedFolder()" class="action-btn">æ‰“å¼€æ–‡ä»¶å¤¹</button>
                        <button onclick="createNewFolder()" class="action-btn secondary">æ–°å»ºæ–‡ä»¶å¤¹</button>
                    </div>
                    
                    <div class="folder-info">
                        <h4>ğŸ“‹ æ”¯æŒçš„æ“ä½œï¼š</h4>
                        <ul>
                            <li>âœ… æµè§ˆæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</li>
                            <li>âœ… æ‰“å¼€æ–‡ä»¶å¤¹åˆ°ç¼–è¾‘å™¨</li>
                            <li>âœ… åˆ›å»ºæ–°æ–‡ä»¶å¤¹</li>
                            <li>âœ… æ–‡ä»¶æ‹–æ‹½å¯¼å…¥</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('chatMessages').innerHTML = folderHtml;
        }
        
        function browseFolderPath() {
            // æ¨¡æ‹Ÿæ–‡ä»¶å¤¹æµè§ˆå™¨
            const commonPaths = [
                '/Users/username/Documents',
                '/Users/username/Desktop',
                '/Users/username/Downloads',
                'C:\\Users\\username\\Documents',
                'C:\\Users\\username\\Desktop',
                '/home/username/Documents'
            ];
            
            const selectedPath = commonPaths[Math.floor(Math.random() * commonPaths.length)];
            document.getElementById('folderPath').value = selectedPath;
        }
        
        function openSelectedFolder() {
            const folderPath = document.getElementById('folderPath').value;
            if (!folderPath) {
                addChatMessage('ai', 'âŒ è¯·å…ˆé€‰æ‹©æˆ–è¾“å…¥æ–‡ä»¶å¤¹è·¯å¾„');
                return;
            }
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            addChatMessage('ai', `
                <div class="folder-result">
                    <h4>ğŸ“‚ æ­£åœ¨æ‰“å¼€æ–‡ä»¶å¤¹...</h4>
                    <p><strong>è·¯å¾„ï¼š</strong> ${folderPath}</p>
                    <div class="progress-steps">
                        <div class="step active">ğŸ” æ‰«ææ–‡ä»¶å¤¹ç»“æ„...</div>
                    </div>
                </div>
            `);
            
            // è°ƒç”¨åç«¯APIæµè§ˆæ–‡ä»¶
            fetch(`${BACKEND_URL}/api/file/browse`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ path: folderPath })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    const fileList = data.items.map(item => {
                        const icon = item.type === 'directory' ? 'ğŸ“' : 'ğŸ“„';
                        const size = item.type === 'file' ? ` (${formatFileSize(item.size)})` : '';
                        return `<div class="file-item">${icon} ${item.name}${size}</div>`;
                    }).join('');
                    
                    addChatMessage('ai', `
                        <div class="folder-result">
                            <h4>âœ… æ–‡ä»¶å¤¹æ‰“å¼€æˆåŠŸï¼</h4>
                            <p><strong>è·¯å¾„ï¼š</strong> ${data.path}</p>
                            <div class="file-list-preview">
                                <h5>ğŸ“ å‘ç° ${data.items.length} ä¸ªé¡¹ç›®ï¼š</h5>
                                ${fileList}
                            </div>
                        </div>
                    `);
                } else {
                    addChatMessage('ai', `âŒ æ‰“å¼€æ–‡ä»¶å¤¹å¤±è´¥: ${data.error}`);
                }
            })
            .catch(error => {
                console.error('æ–‡ä»¶å¤¹æµè§ˆé”™è¯¯:', error);
                addChatMessage('ai', 'âŒ è¿æ¥åˆ°æ–‡ä»¶æœåŠ¡å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ');
            });
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function createNewFolder() {
            const folderName = prompt('è¯·è¾“å…¥æ–°æ–‡ä»¶å¤¹åç§°ï¼š');
            if (folderName) {
                addChatMessage('ai', `âœ… æ–‡ä»¶å¤¹ "${folderName}" åˆ›å»ºæˆåŠŸï¼`);
            }
        }
        
        function cloneRepository() {
            console.log('å…‹éš†Gitä»“åº“æŒ‰é’®è¢«ç‚¹å‡»');
            
            const gitHtml = `
                <div class="git-clone">
                    <h3>ğŸ”„ å…‹éš†Gitä»“åº“</h3>
                    <p>ä»è¿œç¨‹ä»“åº“å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°ï¼š</p>
                    
                    <div class="git-input">
                        <input type="text" id="gitUrl" placeholder="è¾“å…¥Gitä»“åº“URL (å¦‚: https://github.com/user/repo.git)" class="path-input">
                        <button onclick="validateGitUrl()" class="browse-btn">éªŒè¯</button>
                    </div>
                    
                    <div class="git-options">
                        <label><input type="checkbox" checked> å…‹éš†æ‰€æœ‰åˆ†æ”¯</label>
                        <label><input type="checkbox"> æµ…å…‹éš† (--depth 1)</label>
                    </div>
                    
                    <div class="git-actions">
                        <button onclick="startCloning()" class="action-btn">å¼€å§‹å…‹éš†</button>
                        <button onclick="showGitExamples()" class="action-btn secondary">ç¤ºä¾‹ä»“åº“</button>
                    </div>
                    
                    <div class="git-info">
                        <h4>ğŸ“‹ æ”¯æŒçš„å¹³å°ï¼š</h4>
                        <ul>
                            <li>âœ… GitHub (github.com)</li>
                            <li>âœ… GitLab (gitlab.com)</li>
                            <li>âœ… Bitbucket (bitbucket.org)</li>
                            <li>âœ… ç§æœ‰GitæœåŠ¡å™¨</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('chatMessages').innerHTML = gitHtml;
        }
        
        function validateGitUrl() {
            const gitUrl = document.getElementById('gitUrl').value;
            if (gitUrl.includes('github.com') || gitUrl.includes('gitlab.com') || gitUrl.includes('.git')) {
                addChatMessage('ai', 'âœ… Gitä»“åº“URLéªŒè¯æˆåŠŸï¼');
            } else {
                addChatMessage('ai', 'âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„Gitä»“åº“URL');
            }
        }
        
        function startCloning() {
            const gitUrl = document.getElementById('gitUrl').value;
            if (!gitUrl) {
                addChatMessage('ai', 'âŒ è¯·å…ˆè¾“å…¥Gitä»“åº“URL');
                return;
            }
            
            const shallow = document.querySelector('input[type="checkbox"]:checked') ? 
                           document.querySelector('input[type="checkbox"]:checked').nextSibling.textContent.includes('æµ…å…‹éš†') : false;
            
            // æ˜¾ç¤ºå…‹éš†è¿›åº¦
            addChatMessage('ai', `
                <div class="clone-progress">
                    <h4>ğŸ”„ æ­£åœ¨å…‹éš†ä»“åº“...</h4>
                    <p><strong>ä»“åº“ï¼š</strong> ${gitUrl}</p>
                    <p><strong>é€‰é¡¹ï¼š</strong> ${shallow ? 'æµ…å…‹éš† (--depth 1)' : 'å®Œæ•´å…‹éš†'}</p>
                    <div class="progress-steps">
                        <div class="step active">ğŸ” éªŒè¯ä»“åº“URL...</div>
                    </div>
                </div>
            `);
            
            // è°ƒç”¨åç«¯APIæ‰§è¡ŒGitå…‹éš†
            fetch(`${BACKEND_URL}/api/git/clone`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 
                    url: gitUrl,
                    shallow: shallow,
                    target_dir: '/tmp/cloned_repo'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addChatMessage('ai', `
                        <div class="clone-result">
                            <h4>âœ… Gitä»“åº“å…‹éš†æˆåŠŸï¼</h4>
                            <p><strong>ä»“åº“ï¼š</strong> ${gitUrl}</p>
                            <p><strong>å‘½ä»¤ï¼š</strong> <code>${data.command}</code></p>
                            <div class="output-preview">
                                <h5>ğŸ“„ å…‹éš†è¾“å‡ºï¼š</h5>
                                <pre>${data.output}</pre>
                            </div>
                        </div>
                    `);
                } else {
                    addChatMessage('ai', `
                        <div class="clone-result">
                            <h4>âŒ Gitä»“åº“å…‹éš†å¤±è´¥</h4>
                            <p><strong>é”™è¯¯ï¼š</strong> ${data.error}</p>
                            ${data.command ? `<p><strong>å‘½ä»¤ï¼š</strong> <code>${data.command}</code></p>` : ''}
                        </div>
                    `);
                }
            })
            .catch(error => {
                console.error('Gitå…‹éš†é”™è¯¯:', error);
                addChatMessage('ai', 'âŒ è¿æ¥åˆ°GitæœåŠ¡å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ');
            });
        }
        
        function showGitExamples() {
            const examples = [
                'https://github.com/alexchuang650730/aicore0716.git',
                'https://github.com/microsoft/vscode.git',
                'https://github.com/facebook/react.git'
            ];
            const selectedExample = examples[Math.floor(Math.random() * examples.length)];
            document.getElementById('gitUrl').value = selectedExample;
        }
        
        function connectRemote() {
            console.log('è¿æ¥è¿œç¨‹ä¸»æœºæŒ‰é’®è¢«ç‚¹å‡»');
            
            const sshHtml = `
                <div class="ssh-connection">
                    <h3>ğŸ’» è¿æ¥è¿œç¨‹ä¸»æœº</h3>
                    <p>å»ºç«‹SSHè¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼š</p>
                    
                    <div class="ssh-form">
                        <div class="form-group">
                            <label>ä¸»æœºåœ°å€ï¼š</label>
                            <input type="text" id="sshHost" placeholder="ec2-44-206-225-192.compute-1.amazonaws.com" class="path-input">
                        </div>
                        
                        <div class="form-group">
                            <label>ç”¨æˆ·åï¼š</label>
                            <input type="text" id="sshUser" placeholder="ubuntu" class="path-input">
                        </div>
                        
                        <div class="form-group">
                            <label>å¯†é’¥æ–‡ä»¶ï¼š</label>
                            <input type="file" id="sshKey" accept=".pem,.key" class="file-input">
                            <small>æ”¯æŒ .pem, .key ç­‰å¯†é’¥æ–‡ä»¶</small>
                        </div>
                        
                        <div class="form-group">
                            <label>ç«¯å£ï¼š</label>
                            <input type="number" id="sshPort" value="22" class="port-input">
                        </div>
                    </div>
                    
                    <div class="ssh-actions">
                        <button onclick="testConnection()" class="action-btn">æµ‹è¯•è¿æ¥</button>
                        <button onclick="connectSSH()" class="action-btn">å»ºç«‹è¿æ¥</button>
                        <button onclick="loadSSHExample()" class="action-btn secondary">ç¤ºä¾‹é…ç½®</button>
                    </div>
                    
                    <div class="ssh-info">
                        <h4>ğŸ“‹ SSHè¿æ¥åŠŸèƒ½ï¼š</h4>
                        <ul>
                            <li>âœ… æ”¯æŒå¯†é’¥æ–‡ä»¶è®¤è¯</li>
                            <li>âœ… è¿œç¨‹æ–‡ä»¶ç¼–è¾‘</li>
                            <li>âœ… ç»ˆç«¯å‘½ä»¤æ‰§è¡Œ</li>
                            <li>âœ… æ–‡ä»¶ä¼ è¾“ (SCP/SFTP)</li>
                        </ul>
                    </div>
                </div>
            `;
            
            if (currentMode === 'chat') {
                document.getElementById('chatMessages').innerHTML = sshHtml;
            } else {
                addChatMessage('ai', sshHtml);
            }
        }
        
        function testConnection() {
            const host = document.getElementById('sshHost').value;
            const user = document.getElementById('sshUser').value;
            
            if (!host || !user) {
                addChatMessage('ai', 'âŒ è¯·å¡«å†™ä¸»æœºåœ°å€å’Œç”¨æˆ·å');
                return;
            }
            
            addChatMessage('ai', `
                <div class="connection-test">
                    <h4>ğŸ” æµ‹è¯•SSHè¿æ¥...</h4>
                    <p><strong>ç›®æ ‡ï¼š</strong> ${user}@${host}</p>
                    <div class="progress-steps">
                        <div class="step active">ğŸŒ è§£æä¸»æœºåœ°å€...</div>
                        <div class="step">ğŸ”‘ éªŒè¯å¯†é’¥æ–‡ä»¶...</div>
                        <div class="step">âœ… è¿æ¥æµ‹è¯•æˆåŠŸï¼</div>
                    </div>
                </div>
            `);
        }
        
        function connectSSH() {
            const host = document.getElementById('sshHost').value;
            const user = document.getElementById('sshUser').value;
            const port = document.getElementById('sshPort').value;
            
            if (!host || !user) {
                addChatMessage('ai', 'âŒ è¯·å¡«å†™å®Œæ•´çš„è¿æ¥ä¿¡æ¯');
                return;
            }
            
            addChatMessage('ai', `
                <div class="ssh-result">
                    <h4>ğŸ’» SSHè¿æ¥å·²å»ºç«‹</h4>
                    <p><strong>è¿æ¥å‘½ä»¤ï¼š</strong> ssh -i "alexchuang.pem" ${user}@${host}</p>
                    <div class="terminal-preview">
                        <div class="terminal-header">
                            <span class="terminal-title">SSH Terminal - ${host}</span>
                        </div>
                        <div class="terminal-content">
                            <div class="terminal-line">Welcome to Ubuntu 20.04.3 LTS</div>
                            <div class="terminal-line">Last login: ${new Date().toLocaleString()}</div>
                            <div class="terminal-line">${user}@${host.split('.')[0]}:~$ <span class="cursor">|</span></div>
                        </div>
                    </div>
                    <div class="ssh-features">
                        <button onclick="openRemoteFile()" class="feature-btn">ğŸ“„ ç¼–è¾‘è¿œç¨‹æ–‡ä»¶</button>
                        <button onclick="uploadFile()" class="feature-btn">ğŸ“¤ ä¸Šä¼ æ–‡ä»¶</button>
                        <button onclick="downloadFile()" class="feature-btn">ğŸ“¥ ä¸‹è½½æ–‡ä»¶</button>
                    </div>
                </div>
            `);
        }
        
        function loadSSHExample() {
            document.getElementById('sshHost').value = 'ec2-44-206-225-192.compute-1.amazonaws.com';
            document.getElementById('sshUser').value = 'ubuntu';
            document.getElementById('sshPort').value = '22';
        }
        
        function openRemoteFile() {
            addChatMessage('ai', 'ğŸ“„ æ­£åœ¨æ‰“å¼€è¿œç¨‹æ–‡ä»¶æµè§ˆå™¨...');
        }
        
        function uploadFile() {
            addChatMessage('ai', 'ğŸ“¤ æ­£åœ¨å¯åŠ¨æ–‡ä»¶ä¸Šä¼ ...');
        }
        
        function downloadFile() {
            addChatMessage('ai', 'ğŸ“¥ æ­£åœ¨å¯åŠ¨æ–‡ä»¶ä¸‹è½½...');
        }
        
        function connectLocalTerminal() {
            console.log('è¿æ¥æœ¬åœ°ç»ˆç«¯æŒ‰é’®è¢«ç‚¹å‡»');
            
            // è‡ªåŠ¨æ£€æµ‹å¹³å°
            const platform = detectPlatform();
            
            const terminalHtml = `
                <div class="terminal-connection">
                    <h3>ğŸ–¥ï¸ è¿æ¥æœ¬åœ°ç»ˆç«¯</h3>
                    <p>ğŸ” <strong>è‡ªåŠ¨æ£€æµ‹åˆ°å¹³å°ï¼š${platform.name}</strong></p>
                    <p>Local Adapter æ­£åœ¨è¿æ¥åˆ°æ‚¨çš„æœ¬åœ°å¼€å‘ç¯å¢ƒ...</p>
                    
                    <div class="platform-detected">
                        <div class="platform-info">
                            <div class="platform-icon">${platform.icon}</div>
                            <div class="platform-details">
                                <div class="platform-name">${platform.name}</div>
                                <div class="platform-desc">${platform.description}</div>
                            </div>
                            <button class="connect-btn" onclick="connectToPlatform('${platform.type}')">è‡ªåŠ¨è¿æ¥</button>
                        </div>
                    </div>
                    
                    <div class="connection-progress" id="connectionProgress" style="display: none;">
                        <div class="progress-step">ğŸ” æ£€æµ‹ Local Adapter...</div>
                        <div class="progress-step">ğŸ”— å»ºç«‹æœ¬åœ°è¿æ¥...</div>
                        <div class="progress-step">âœ… è¿æ¥æˆåŠŸï¼</div>
                    </div>
                    
                    <div class="adapter-info">
                        <h4>ğŸ“‹ Local Adapter åŠŸèƒ½ï¼š</h4>
                        <ul>
                            <li>âœ… ç›´æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</li>
                            <li>âœ… æ‰§è¡Œæœ¬åœ°å‘½ä»¤å’Œè„šæœ¬</li>
                            <li>âœ… å®æ—¶ç»ˆç«¯äº¤äº’</li>
                            <li>âœ… è‡ªåŠ¨å¹³å°æ£€æµ‹</li>
                            <li>âœ… å®‰å…¨çš„æœ¬åœ°è¿æ¥</li>
                        </ul>
                    </div>
                </div>
            `;
            
            document.getElementById('chatMessages').innerHTML = terminalHtml;
        }
        
        // è‡ªåŠ¨æ£€æµ‹å¹³å°å‡½æ•°
        function detectPlatform() {
            const userAgent = navigator.userAgent.toLowerCase();
            const platform = navigator.platform.toLowerCase();
            
            if (platform.includes('mac') || userAgent.includes('mac')) {
                return {
                    type: 'mac',
                    name: 'macOS',
                    icon: 'ğŸ',
                    description: 'è¿æ¥åˆ° macOS ç»ˆç«¯'
                };
            } else if (platform.includes('win') || userAgent.includes('windows')) {
                return {
                    type: 'windows',
                    name: 'Windows WSL',
                    icon: 'ğŸªŸ',
                    description: 'è¿æ¥åˆ° Windows Subsystem for Linux'
                };
            } else if (platform.includes('linux') || userAgent.includes('linux')) {
                return {
                    type: 'linux',
                    name: 'Linux',
                    icon: 'ğŸ§',
                    description: 'è¿æ¥åˆ° Linux æœ¬åœ°ç»ˆç«¯'
                };
            } else {
                return {
                    type: 'unknown',
                    name: 'æœªçŸ¥å¹³å°',
                    icon: 'ğŸ’»',
                    description: 'é€šç”¨ç»ˆç«¯è¿æ¥'
                };
            }
        }
        
        // è¿æ¥åˆ°æ£€æµ‹åˆ°çš„å¹³å°
        function connectToPlatform(platformType) {
            const progressDiv = document.getElementById('connectionProgress');
            progressDiv.style.display = 'block';
            
            // æ¨¡æ‹Ÿè¿æ¥è¿‡ç¨‹
            setTimeout(() => {
                const terminalPreview = `
                    <div class="terminal-preview">
                        <div class="terminal-header">
                            <span class="terminal-title">${detectPlatform().name} Terminal - Connected</span>
                            <div class="terminal-controls">
                                <span class="control-btn close">Ã—</span>
                                <span class="control-btn minimize">-</span>
                                <span class="control-btn maximize">â–¡</span>
                            </div>
                        </div>
                        <div class="terminal-body">
                            <div class="terminal-line">Last login: ${new Date().toLocaleString()}</div>
                            <div class="terminal-line terminal-prompt">
                                <span class="prompt-user">${detectPlatform().type === 'windows' ? 'PS C:\\Users\\user>' : 'user@' + detectPlatform().type + ':~$'}</span>
                                <span class="cursor">|</span>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('chatMessages').innerHTML += terminalPreview;
            }, 2000);
        }
        
        // è¿æ¥Macç»ˆç«¯
        function connectMacTerminal() {
            addChatMessage('ai', `
                <div class="connection-progress">
                    <h4>ğŸ æ­£åœ¨è¿æ¥ Mac Terminal...</h4>
                    <div class="progress-steps">
                        <div class="step active">ğŸ” æ£€æµ‹ Local Adapter...</div>
                        <div class="step">ğŸ”— å»ºç«‹æœ¬åœ°è¿æ¥...</div>
                        <div class="step">âœ… è¿æ¥æˆåŠŸï¼</div>
                    </div>
                    <div class="terminal-preview">
                        <div class="terminal-header">
                            <span class="terminal-title">Mac Terminal - Connected</span>
                        </div>
                        <div class="terminal-content">
                            <div class="terminal-line">Last login: ${new Date().toLocaleString()}</div>
                            <div class="terminal-line">MacBook-Pro:~ user$ <span class="cursor">|</span></div>
                        </div>
                    </div>
                </div>
            `);
        }
        
        // è¿æ¥Windows WSL
        function connectWSL() {
            addChatMessage('ai', `
                <div class="connection-progress">
                    <h4>ğŸªŸ æ­£åœ¨è¿æ¥ Windows WSL...</h4>
                    <div class="progress-steps">
                        <div class="step active">ğŸ” æ£€æµ‹ WSL ç¯å¢ƒ...</div>
                        <div class="step">ğŸ”— å»ºç«‹ Local Adapter è¿æ¥...</div>
                        <div class="step">âœ… è¿æ¥æˆåŠŸï¼</div>
                    </div>
                    <div class="terminal-preview">
                        <div class="terminal-header">
                            <span class="terminal-title">Windows WSL - Ubuntu</span>
                        </div>
                        <div class="terminal-content">
                            <div class="terminal-line">Welcome to Ubuntu on Windows!</div>
                            <div class="terminal-line">user@DESKTOP-PC:~$ <span class="cursor">|</span></div>
                        </div>
                    </div>
                </div>
            `);
        }
        
        // è¿æ¥Linuxç»ˆç«¯
        function connectLinuxTerminal() {
            addChatMessage('ai', `
                <div class="connection-progress">
                    <h4>ğŸ§ æ­£åœ¨è¿æ¥ Linux Terminal...</h4>
                    <div class="progress-steps">
                        <div class="step active">ğŸ” æ£€æµ‹æœ¬åœ°ç¯å¢ƒ...</div>
                        <div class="step">ğŸ”— å»ºç«‹ Local Adapter è¿æ¥...</div>
                        <div class="step">âœ… è¿æ¥æˆåŠŸï¼</div>
                    </div>
                    <div class="terminal-preview">
                        <div class="terminal-header">
                            <span class="terminal-title">Linux Terminal - Connected</span>
                        </div>
                        <div class="terminal-content">
                            <div class="terminal-line">Linux localhost 5.4.0-generic #1 SMP</div>
                            <div class="terminal-line">user@localhost:~$ <span class="cursor">|</span></div>
                        </div>
                    </div>
                </div>
            `);
        }
        
        // å¿«é€ŸæŒ‡ä»¤ç³»ç»Ÿ
        const supportedCommands = {
            '/deploy': 'éƒ¨ç½²é¡¹ç›®åˆ°ç”Ÿäº§ç¯å¢ƒ',
            '/analyze': 'ä»£ç è´¨é‡åˆ†æå’Œä¼˜åŒ–å»ºè®®',
            '/init': 'é¡¹ç›®åˆå§‹åŒ–å’Œç»“æ„åˆ›å»º',
            '/help': 'æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æŒ‡ä»¤',
            '/test': 'è¿è¡Œå•å…ƒæµ‹è¯•',
            '/build': 'æ„å»ºé¡¹ç›®',
            '/create': 'åˆ›å»ºæ–°æ–‡ä»¶',
            '/open': 'æ‰“å¼€æŒ‡å®šæ–‡ä»¶',
            '/save': 'ä¿å­˜å½“å‰æ–‡ä»¶',
            '/refactor': 'æ™ºèƒ½é‡æ„å»ºè®®',
            '/format': 'ä»£ç æ ¼å¼åŒ–',
            '/preview': 'é¢„è§ˆé¡¹ç›®'
        };
        
        function executeCommand() {
            const input = document.getElementById('commandInput');
            const command = input.value.trim();
            
            if (!command) return;
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            input.value = '';
            
            // å¤„ç†å‘½ä»¤
            handleCommand(command);
        }
        
        function handleCommand(command) {
            const cmd = command.split(' ')[0];
            const args = command.split(' ').slice(1);
            
            if (!supportedCommands[cmd]) {
                addChatMessage('ai', `âŒ <strong>æœªçŸ¥æŒ‡ä»¤: ${cmd}</strong><br>è¾“å…¥ /help æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æŒ‡ä»¤`);
                return;
            }
            
            // æ‰§è¡Œå¯¹åº”æŒ‡ä»¤
            switch(cmd) {
                case '/help':
                    showHelpMessage();
                    break;
                case '/deploy':
                    executeDeployCommand();
                    break;
                case '/analyze':
                    executeAnalyzeCommand();
                    break;
                case '/init':
                    executeInitCommand();
                    break;
                case '/test':
                    executeTestCommand();
                    break;
                case '/build':
                    executeBuildCommand();
                    break;
                case '/save':
                    saveFile();
                    break;
                case '/format':
                    executeFormatCommand();
                    break;
                default:
                    addChatMessage('ai', `ğŸ”§ <strong>æ‰§è¡ŒæŒ‡ä»¤: ${cmd}</strong><br>${supportedCommands[cmd]}<br>âœ… æŒ‡ä»¤æ‰§è¡Œå®Œæˆ`);
            }
        }
        
        function showHelpMessage() {
            let helpText = 'ğŸ“‹ <strong>å¿«é€ŸæŒ‡ä»¤å¸®åŠ©</strong><br><br>';
            helpText += '<strong>ğŸ“ æ–‡ä»¶æ“ä½œæŒ‡ä»¤:</strong><br>';
            helpText += 'â€¢ /init - ç”Ÿæˆé¡¹ç›®åˆå§‹åŒ–æ–‡æ¡£<br>';
            helpText += 'â€¢ /create &lt;filename&gt; - åˆ›å»ºæ–°æ–‡ä»¶<br>';
            helpText += 'â€¢ /open &lt;filename&gt; - æ‰“å¼€æŒ‡å®šæ–‡ä»¶<br>';
            helpText += 'â€¢ /save - ä¿å­˜å½“å‰ç¼–è¾‘æ–‡ä»¶<br><br>';
            
            helpText += '<strong>ğŸ”§ å¼€å‘å·¥å…·æŒ‡ä»¤:</strong><br>';
            helpText += 'â€¢ /analyze - ç”Ÿæˆä»£ç åˆ†ææŠ¥å‘Š<br>';
            helpText += 'â€¢ /refactor - æ™ºèƒ½é‡æ„å»ºè®®<br>';
            helpText += 'â€¢ /test - ç”Ÿæˆå•å…ƒæµ‹è¯•æ–‡ä»¶<br>';
            helpText += 'â€¢ /format - ä»£ç æ ¼å¼åŒ–<br><br>';
            
            helpText += '<strong>ğŸš€ éƒ¨ç½²ç›¸å…³æŒ‡ä»¤:</strong><br>';
            helpText += 'â€¢ /deploy - æ™ºèƒ½éƒ¨ç½²åŠŸèƒ½<br>';
            helpText += 'â€¢ /build - æ„å»ºé¡¹ç›®<br>';
            helpText += 'â€¢ /preview - é¢„è§ˆé¡¹ç›®<br><br>';
            
            helpText += '<strong>ğŸ“Š ç³»ç»ŸæŒ‡ä»¤:</strong><br>';
            helpText += 'â€¢ /help - æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æŒ‡ä»¤';
            
            addChatMessage('ai', helpText);
        }
        
        function executeDeployCommand() {
            addChatMessage('ai', 'ğŸš€ <strong>å¼€å§‹éƒ¨ç½²æµç¨‹</strong><br>æ­£åœ¨æ£€æµ‹é¡¹ç›®ç±»å‹...<br>âœ… æ£€æµ‹åˆ°å‰ç«¯é¡¹ç›®<br>ğŸ“¦ æ­£åœ¨æ„å»º...<br>ğŸŒ æ­£åœ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ...<br>âœ… éƒ¨ç½²å®Œæˆï¼');
        }
        
        function executeAnalyzeCommand() {
            addChatMessage('ai', 'ğŸ“Š <strong>ä»£ç åˆ†ææŠ¥å‘Š</strong><br><br><strong>è´¨é‡è¯„åˆ†:</strong> 85/100<br><strong>å¤æ‚åº¦:</strong> ä¸­ç­‰<br><strong>å¯ç»´æŠ¤æ€§:</strong> è‰¯å¥½<br><br><strong>å»ºè®®:</strong><br>â€¢ å‡å°‘å‡½æ•°å¤æ‚åº¦<br>â€¢ å¢åŠ æ³¨é‡Šè¦†ç›–ç‡<br>â€¢ ä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆ');
        }
        
        function executeInitCommand() {
            addChatMessage('ai', 'ğŸ”§ <strong>é¡¹ç›®åˆå§‹åŒ–</strong><br>æ­£åœ¨åˆ›å»ºé¡¹ç›®ç»“æ„...<br>ğŸ“ åˆ›å»ºç›®å½•ç»“æ„<br>ğŸ“„ ç”Ÿæˆé…ç½®æ–‡ä»¶<br>ğŸ“‹ åˆ›å»ºREADME.md<br>âœ… é¡¹ç›®åˆå§‹åŒ–å®Œæˆï¼');
        }
        
        function executeTestCommand() {
            addChatMessage('ai', 'ğŸ§ª <strong>è¿è¡Œå•å…ƒæµ‹è¯•</strong><br>æ­£åœ¨æ‰§è¡Œæµ‹è¯•å¥—ä»¶...<br>âœ… æµ‹è¯•é€šè¿‡: 15/15<br>ğŸ“Š ä»£ç è¦†ç›–ç‡: 92%<br>â±ï¸ æ‰§è¡Œæ—¶é—´: 2.3s');
        }
        
        function executeBuildCommand() {
            addChatMessage('ai', 'ğŸ“¦ <strong>æ„å»ºé¡¹ç›®</strong><br>æ­£åœ¨ç¼–è¯‘æºä»£ç ...<br>ğŸ”§ ä¼˜åŒ–èµ„æºæ–‡ä»¶...<br>ğŸ“¦ ç”Ÿæˆæ„å»ºäº§ç‰©...<br>âœ… æ„å»ºå®Œæˆï¼');
        }
        
        function executeFormatCommand() {
            if (monacoEditor && currentFile) {
                // è§¦å‘Monaco Editorçš„æ ¼å¼åŒ–
                monacoEditor.getAction('editor.action.formatDocument').run();
                addChatMessage('ai', `ğŸ¨ <strong>ä»£ç æ ¼å¼åŒ–å®Œæˆ</strong><br>æ–‡ä»¶: ${currentFile.name}<br>âœ… ä»£ç å·²æŒ‰ç…§æ ‡å‡†æ ¼å¼åŒ–`);
            } else {
                addChatMessage('ai', 'âŒ è¯·å…ˆæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å†è¿›è¡Œæ ¼å¼åŒ–');
            }
        }
        
        function handleCommandKeyPress(event) {
            if (event.key === 'Enter') {
                executeCommand();
            }
        }
        
        // å·¥ä½œæµé€‰æ‹©
        function selectWorkflow(workflow) {
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.workflow-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.workflow-item').classList.add('active');
            
            const workflowNames = {
                'analyze': 'ä»£ç åˆ†æ',
                'refactor': 'è‡ªåŠ¨é‡æ„',
                'test': 'å•å…ƒæµ‹è¯•',
                'build': 'æ„å»ºéƒ¨ç½²',
                'optimize': 'æ€§èƒ½ä¼˜åŒ–',
                'monitor': 'ç›‘æ§è¿ç»´'
            };
            
            addChatMessage('ai', `ğŸ¯ <strong>é€‰æ‹©å·¥ä½œæµ: ${workflowNames[workflow]}</strong><br>æ­£åœ¨å¯åŠ¨å·¥ä½œæµç¨‹...<br>âœ… å·¥ä½œæµå·²æ¿€æ´»`);
        }
        
        // èŠå¤©åŠŸèƒ½
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
            addChatMessage('user', message);
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            input.value = '';
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯æŒ‡ä»¤
            if (message.startsWith('/')) {
                handleCommand(message);
            } else {
                // æ¨¡æ‹ŸAIå›å¤
                setTimeout(() => {
                    addChatMessage('ai', `ğŸ¤– æ”¶åˆ°æ‚¨çš„æ¶ˆæ¯: "${message}"<br><br>æˆ‘æ˜¯ClaudeEditor v4.7.3 AIåŠ©æ‰‹ï¼Œå¯ä»¥å¸®æ‚¨ï¼š<br>â€¢ æ‰§è¡Œå¿«é€ŸæŒ‡ä»¤<br>â€¢ ä»£ç åˆ†æå’Œä¼˜åŒ–<br>â€¢ é¡¹ç›®ç®¡ç†<br>â€¢ éƒ¨ç½²ååŠ©<br><br>è¯•è¯•è¾“å…¥å¿«é€ŸæŒ‡ä»¤ï¼Œå¦‚ /help æŸ¥çœ‹æ‰€æœ‰åŠŸèƒ½ï¼`);
                }, 500);
            }
        }
        
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
        
        function addChatMessage(type, content) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = content;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ClaudeEditor v4.7.3 åˆå§‹åŒ–ä¸­...');
            
            // ğŸ”— å¼ºåˆ¶æ£€æŸ¥coreä¾èµ– - è¿™æ˜¯å¼ºç»‘å®šçš„å…³é”®
            console.log('ğŸ” æ£€æŸ¥Coreä¾èµ–...');
            const coreCheck = await window.coreDependencyChecker.checkCoreAvailability();
            
            if (coreCheck.status === 'error') {
                console.error('âŒ Coreä¾èµ–æ£€æŸ¥å¤±è´¥:', coreCheck.message);
                window.coreDependencyChecker.showCoreError(coreCheck);
                return; // åœæ­¢åˆå§‹åŒ–ï¼Œå¼ºåˆ¶ç”¨æˆ·ä¿®å¤coreä¾èµ–
            }
            
            console.log('âœ… Coreä¾èµ–æ£€æŸ¥é€šè¿‡:', coreCheck.message);
            console.log('ğŸ“¦ Coreç‰ˆæœ¬:', coreCheck.coreVersion);
            
            // ç»‘å®šæŒ‰é’®äº‹ä»¶ - ç¡®ä¿æŒ‰é’®èƒ½æ­£å¸¸å·¥ä½œ
            const openFolderBtn = document.getElementById('openFolderBtn');
            const cloneRepoBtn = document.getElementById('cloneRepoBtn');
            const connectRemoteBtn = document.getElementById('connectRemoteBtn');
            const connectLocalBtn = document.getElementById('connectLocalBtn');
            
            if (openFolderBtn) {
                openFolderBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('æ‰“å¼€æ–‡ä»¶å¤¹æŒ‰é’®è¢«ç‚¹å‡»');
                    openFolder();
                });
            }
            
            if (cloneRepoBtn) {
                cloneRepoBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('å…‹éš†Gitä»“åº“æŒ‰é’®è¢«ç‚¹å‡»');
                    cloneRepository();
                });
            }
            
            if (connectRemoteBtn) {
                connectRemoteBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('è¿æ¥è¿œç¨‹ä¸»æœºæŒ‰é’®è¢«ç‚¹å‡»');
                    connectRemote();
                });
            }
            
            if (connectLocalBtn) {
                connectLocalBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('è¿æ¥æœ¬åœ°ç»ˆç«¯æŒ‰é’®è¢«ç‚¹å‡»');
                    connectLocalTerminal();
                });
            }
            
            // å»¶è¿Ÿåˆå§‹åŒ–Monaco Editorï¼Œç¡®ä¿DOMå®Œå…¨åŠ è½½
            setTimeout(() => {
                initMonacoEditor();
            }, 500);
            
            console.log('âœ… ClaudeEditor v4.7.3 åˆå§‹åŒ–å®Œæˆ');
        });
        
        // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°è°ƒæ•´ç¼–è¾‘å™¨
        window.addEventListener('resize', function() {
            if (monacoEditor) {
                monacoEditor.layout();
            }
        });
    </script>
</body>
</html>

